# -*- coding: UTF-8 -*-
# -----------------------------------------------------------------------------
#     Copyright (c) 2014+ Type Network
#
#     T N  B I T S
#     No distribution without permission.
#
# -----------------------------------------------------------------------------
#
#    fontinfo.py
#
class FontInfo:

    # ---------------------------------------------------------------------------------------------------------
    # T R U E T Y P E  T A B L E  N A M E S

    TABLE_HEAD = 'head'
    TABLE_MAXP = 'maxp'
    TABLE_CMAP = 'cmap'
    TABLE_GLYF = 'glyf'
    TABLE_GSUB = 'GSUB'
    TABLE_GPOS = 'GPOS'
    TABLE_GDEF = 'GDEF'
    TABLE_GASP = 'gasp'
    TABLE_HMTX = 'hmtx'
    TABLE_HHEA = 'hhea'
    TABLE_LOCA = 'loca'
    TABLE_KERN = 'kern'
    TABLE_NAME = 'name'
    TABLE_FPGM = 'fpgm'
    TABLE_PREP = 'prep'
    TABLE_OS2 = 'OS/2'
    TABLE_CFF = 'CFF '
    TABLE_CVT = 'cvt '
    TABLE_POST = 'post'

    # ---------------------------------------------------------------------------------------------------------
    #    F O N T I N F O

    NORMALIZED_PPEM = 1000.0 # To scale the stems of arbitrary ppem to normalized ppem

    ##########
    # FONT INFO
    ##########

    FONTINFO_NAME_LENGTHS = {
    'familyName': 27,
    'styleName': 31,
    'postscriptFontName': 31,
    'postscriptFullName': 63,
    'styleMapFamilyName': 27,
    'macintoshFONDName': 31,
    'openTypeNamePreferredFamilyName': 31,
    'openTypeNamePreferredSubfamilyName': 31,
    }

    FONTINFO_ATTRS = [
        'ascender',
        'capHeight',
        'copyright',
        'descender',
        'familyName',
        'italicAngle',
        'macintoshFONDFamilyID',
        'macintoshFONDName',
        'note',
        'openTypeHeadCreated',
        'openTypeHeadFlags',
        'openTypeHeadLowestRecPPEM',
        'openTypeHheaAscender',
        'openTypeHheaCaretOffset',
        'openTypeHheaCaretSlopeRise',
        'openTypeHheaCaretSlopeRun',
        'openTypeHheaDescender',
        'openTypeHheaLineGap',
        'openTypeNameCompatibleFullName',
        'openTypeNameDescription',
        'openTypeNameDesigner',
        'openTypeNameDesignerURL',
        'openTypeNameLicense',
        'openTypeNameLicenseURL',
        'openTypeNameManufacturer',
        'openTypeNameManufacturerURL',
        'openTypeNamePreferredFamilyName',
        'openTypeNamePreferredSubfamilyName',
        'openTypeNameSampleText',
        'openTypeNameUniqueID',
        'openTypeNameVersion',
        'openTypeNameWWSFamilyName',
        'openTypeNameWWSSubfamilyName',
        'openTypeOS2CodePageRanges',
        'openTypeOS2FamilyClass',
        'openTypeOS2Panose',
        'openTypeOS2Selection',
        'openTypeOS2StrikeoutPosition',
        'openTypeOS2StrikeoutSize',
        'openTypeOS2SubscriptXOffset',
        'openTypeOS2SubscriptXSize',
        'openTypeOS2SubscriptYOffset',
        'openTypeOS2SubscriptYSize',
        'openTypeOS2SuperscriptXOffset',
        'openTypeOS2SuperscriptXSize',
        'openTypeOS2SuperscriptYOffset',
        'openTypeOS2SuperscriptYSize',
        'openTypeOS2Type',
        'openTypeOS2TypoAscender',
        'openTypeOS2TypoDescender',
        'openTypeOS2TypoLineGap',
        'openTypeOS2UnicodeRanges',
        'openTypeOS2VendorID',
        #'FBOS2WeightClass', # Same as openTypeOS2WeightClass running 100-999 in 1 incrementals.
        'openTypeOS2WeightClass',
        'openTypeOS2WidthClass',
        'openTypeOS2WinAscent',
        'openTypeOS2WinDescent',
        'openTypeVheaCaretOffset',
        'openTypeVheaCaretSlopeRise',
        'openTypeVheaCaretSlopeRun',
        'openTypeVheaVertTypoAscender',
        'openTypeVheaVertTypoDescender',
        'openTypeVheaVertTypoLineGap',
        'postscriptBlueFuzz',
        'postscriptBlueScale',
        'postscriptBlueShift',
        'postscriptBlueValues',
        'postscriptDefaultCharacter',
        'postscriptDefaultWidthX',
        'postscriptFamilyBlues',
        'postscriptFamilyOtherBlues',
        'postscriptFontName',
        'postscriptForceBold',
        'postscriptFullName',
        'postscriptIsFixedPitch',
        'postscriptNominalWidthX',
        'postscriptOtherBlues',
        'postscriptSlantAngle',
        'postscriptStemSnapH',
        'postscriptStemSnapV',
        'postscriptUnderlinePosition',
        'postscriptUnderlineThickness',
        'postscriptUniqueID',
        'postscriptWeightName',
        'postscriptWindowsCharacterSet',
        'styleMapFamilyName',
        'styleMapStyleName',
        'styleName',
        'trademark',
        'unitsPerEm',
        'versionMajor',
        'versionMinor',
        'xHeight',
        'year',
        
        # -----
        'openTypeNameRecords'
        ]

    #from lib.UI.fontInfoSheet import _infoAttribute, DummyInfo
    #emptyFont = f.naked().__class__(infoClass=DummyInfo)

    FONTINFO_DEFAULTS = {
        'ascender': (750, int),
        'capHeight': (750, int),
        'copyright': ('', str),
        'descender': (-250, int),
        'familyName': ('Untitled', str),
        'italicAngle': (0, float),
        'macintoshFONDFamilyID': (None, None),
        'macintoshFONDName': (None, None),
        'note': ('', str),
        'openTypeHeadFlags': (None, None),
        'openTypeHeadLowestRecPPEM': (None, None),
        'openTypeHheaAscender': (None, None),
        'openTypeHheaCaretOffset': (None, None),
        'openTypeHheaCaretSlopeRise': (None, None),
        'openTypeHheaCaretSlopeRun': (None, None),
        'openTypeHheaDescender': (None, None),
        'openTypeHheaLineGap': (None, None),
        'openTypeNameCompatibleFullName': (None, None),
        'openTypeNameDescription': (None, None),
        'openTypeNameDesigner': (None, None),
        'openTypeNameDesignerURL': (None, None),
        'openTypeNameLicense': (None, None),
        'openTypeNameLicenseURL': (None, None),
        'openTypeNameManufacturer': (None, None),
        'openTypeNameManufacturerURL': (None, None),
        'openTypeNamePreferredFamilyName': (None, None),
        'openTypeNamePreferredSubfamilyName': (None, None),
        'openTypeNameSampleText': (None, None),
        'openTypeNameUniqueID': (None, None),
        'openTypeNameVersion': (None, None),
        'openTypeNameWWSFamilyName': (None, None),
        'openTypeNameWWSSubfamilyName': (None, None),
        'openTypeOS2CodePageRanges': (None, None),
        'openTypeOS2FamilyClass': (None, None),
        'openTypeOS2Panose': (None, None),
        'openTypeOS2Selection': (None, None),
        'openTypeOS2StrikeoutPosition': (None, None),
        'openTypeOS2StrikeoutSize': (None, None),
        'openTypeOS2SubscriptXOffset': (None, None),
        'openTypeOS2SubscriptXSize': (None, None),
        'openTypeOS2SubscriptYOffset': (None, None),
        'openTypeOS2SubscriptYSize': (None, None),
        'openTypeOS2SuperscriptXOffset': (None, None),
        'openTypeOS2SuperscriptXSize': (None, None),
        'openTypeOS2SuperscriptYOffset': (None, None),
        'openTypeOS2SuperscriptYSize': (None, None),
        'openTypeOS2Type': (None, None),
        'openTypeOS2TypoAscender': (None, None),
        'openTypeOS2TypoDescender': (None, None),
        'openTypeOS2TypoLineGap': (None, None),
        'openTypeOS2UnicodeRanges': (None, None),
        'openTypeOS2VendorID': (None, None),
        'openTypeOS2WeightClass': (None, None),
        'openTypeOS2WidthClass': (None, None),
        'openTypeOS2WinAscent': (None, None),
        'openTypeOS2WinDescent': (None, None),
        'openTypeVheaCaretOffset': (None, None),
        'openTypeVheaCaretSlopeRise': (None, None),
        'openTypeVheaCaretSlopeRun': (None, None),
        'openTypeVheaVertTypoAscender': (None, None),
        'openTypeVheaVertTypoDescender': (None, None),
        'openTypeVheaVertTypoLineGap': (None, None),
        'postscriptBlueScale': (None, None),
        'postscriptBlueShift': (None, None),
        'postscriptBlueValues': ([], list),
        'postscriptDefaultCharacter': (None, None),
        'postscriptDefaultWidthX': (None, None),
        'postscriptFamilyBlues': ([], list),
        'postscriptFamilyOtherBlues': ([], list),
        'postscriptFontName': (None, str),
        'postscriptForceBold': (None, None),
        'postscriptFullName': (None, str),
        'postscriptIsFixedPitch': (None, None),
        'postscriptNominalWidthX': (None, None),
        'postscriptOtherBlues': ([], list),
        'postscriptSlantAngle': (0, float),
        'postscriptStemSnapH': ([], list),
        'postscriptStemSnapV': ([], list),
        'postscriptUnderlinePosition': (None, None),
        'postscriptUnderlineThickness': (None, None),
        'postscriptUniqueID': (None, None),
        'postscriptWeightName': (None, None),
        'postscriptWindowsCharacterSet': (None, None),
        'styleMapStyleName': (None, None),
        'styleName': ('Regular', str),
        'trademark': ('', str),
        'unitsPerEm': (1000, int),
        'versionMajor': (1.0, float),
        'versionMinor': (1.0, float),
        'xHeight': (500, int),
        'year': (0, int),
        'recordId': (0, int), # Not in font.info, but accessable in database record.
    }

    FONTINFO_ATTRS_WITHOUT_DEFAULT = ['familyName', 'styleName', 'versionMajor', 'versionMinor', 'unitsPerEm', 'descender', 'xHeight', 'capHeight', 'ascender', 'italicAngle', 'copyright', 'trademark', 'license', 'licenseURL', 'openTypeNameDesigner', 'openTypeNameDesignerURL', 'openTypeNameManufacturer', 'openTypeNameManufacturerURL', 'note', 'openTypeNameDescription', 'openTypeNameSampleText', 'openTypeOS2WidthClass', 'openTypeOS2WeightClass', 'openTypeSelection', 'openTypeOS2VendorID', 'openTypeOS2Type', 'openTypeOS2UnicodeRanges', 'openTypeOS2CodePageRanges', 'openTypeOS2Panose', 'postscriptBlueValues', 'postscriptFamilyOtherBlues', 'postscriptFamilyBlues', 'postscriptFamilyOtherBlues', 'postscriptStemSnapH', 'postscriptStemSnapV']

    FONTINFO_ATTRS_BASIC = ['familyName', 'styleName', 'versionMajor', 'versionMinor', 'unitsPerEm', 'descender', 'xHeight', 'capHeight', 'ascender', 'italicAngle', 'openTypeNameDesigner', 'openTypeNameDesignerURL', 'openTypeNameManufacturer', 'openTypeNameManufacturerURL', 'note', 'openTypeOS2WidthClass', 'openTypeOS2WeightClass', 'openTypeOS2Selection', 'openTypeOS2VendorID']

    FONTINFO_ATTRS_SETTABLE = ['openTypeOS2WidthClass', 'openTypeOS2WeightClass', 'openTypeOS2CodePageRanges', 'openTypeOS2UnicodeRanges', 'openTypeOS2Panose']

    FONTINFO_ATTRS_SCALABLE_UNKNOWN = [
                      'openTypeHeadFlags',
                      'openTypeHheaCaretOffset',
                      'openTypeHheaCaretSlopeRise',
                      'openTypeHheaCaretSlopeRun',
                      'postscriptBlueScale',
                      'postscriptBlueShift',
                      'postscriptBlueFuzz',
                      'postscriptBlueValues',
                      'postscriptFamilyBlues',
                      'postscriptFamilyOtherBlues',
                      'postscriptOtherBlues',
                      'openTypeVheaCaretOffset',
                      'openTypeVheaCaretSlopeRise',
                      'openTypeVheaCaretSlopeRun',
                                       ]

    FONTINFO_ATTRS_SCALABLE_X = [
                      'openTypeOS2SubscriptXOffset',
                      'openTypeOS2SubscriptXSize',
                      'openTypeOS2SuperscriptXOffset',
                      'openTypeOS2SuperscriptXSize',
                      'postscriptDefaultWidthX',
                      'postscriptNominalWidthX',
                      'postscriptStemSnapH',
                        ]

    FONTINFO_ATTRS_SCALABLE_Y = [
                      'ascender',
                      'capHeight',
                      'descender',
                      'openTypeHheaAscender',
                      'openTypeHheaDescender',
                      'openTypeHheaLineGap',
                      'openTypeOS2StrikeoutPosition',
                      'openTypeOS2StrikeoutSize',
                      'openTypeOS2SubscriptYOffset',
                      'openTypeOS2SubscriptYSize',
                      'openTypeOS2SuperscriptYOffset',
                      'openTypeOS2SuperscriptYSize',
                      'openTypeOS2TypoAscender',
                      'openTypeOS2TypoDescender',
                      'openTypeOS2TypoLineGap',
                      'openTypeOS2WinAscent',
                      'openTypeOS2WinDescent',
                      'openTypeVheaVertTypoAscender',
                      'openTypeVheaVertTypoDescender',
                      'openTypeVheaVertTypoLineGap',
                      'postscriptStemSnapV',
                      'postscriptUnderlinePosition',
                      'postscriptUnderlineThickness',
                      'unitsPerEm',
                      'xHeight',
                      ]

    FONTINFO_ATTRS_SCALABLE = FONTINFO_ATTRS_SCALABLE_Y + FONTINFO_ATTRS_SCALABLE_X

    FONTINFO_OS2_CODEPAGE_RANGES = {
                    1252: 0,
                    1250: 1,
                    1251: 2,
                    1253: 3,
                    1254: 4,
                    1255: 5,
                    1256: 6,
                    1257: 7,
                    1258: 8,
                    874: 16,
                    932: 17,
                    936: 18,
                    949: 19,
                    950: 20,
                    1361: 21,
                    'Mac Roman': 29,
                    869: 48,
                    866: 49,
                    865: 50,
                    864: 51,
                    863: 52,
                    862: 53,
                    861: 54,
                    860: 55,
                    857: 56,
                    855: 57,
                    852: 58,
                    775: 59,
                    737: 60,
                    708: 61,
                    850: 62,
                    437: 63
                }

    FONTINFO_OS2_UNICODE_RANGES = {
                    (0, 127): 0,
                    (128, 255): 1,
                    (256, 383): 2,
                    (384, 591): 3,
                    (592, 687): 4,
                    (7424, 7551): 4,
                    (7552, 7615): 4,
                    (688, 767): 5,
                    (42752, 42783): 5,
                    (768, 879): 6,
                    (7616, 7679): 6,
                    (880, 1023): 7,
                    (11392, 11519): 8,
                    (1024, 1279): 9,
                    (1280, 1327): 9,
                    (11744, 11775): 9,
                    (42560, 42655): 9,
                    (1328, 1423): 10,
                    (1424, 1535): 11,
                    (42240, 42559): 12,
                    (1536, 1791): 13,
                    (1872, 1919): 13,
                    (1984, 2047): 14,
                    (2304, 2431): 15,
                    (2432, 2559): 16,
                    (2560, 2687): 17,
                    (2688, 2815): 18,
                    (2816, 2943): 19,
                    (2944, 3071): 20,
                    (3072, 3199): 21,
                    (3200, 3327): 22,
                    (3328, 3455): 23,
                    (3584, 3711): 24,
                    (3712, 3839): 25,
                    (4256, 4351): 26,
                    (11520, 11567): 26,
                    (6912, 7039): 27,
                    (4352, 4607): 28,
                    (7680, 7935): 29,
                    (11360, 11391): 29,
                    (42784, 43007): 29,
                    (7936, 8191): 30,
                    (8192, 8303): 31,
                    (11776, 11903): 31,
                    (8304, 8351): 32,
                    (8352, 8399): 33,
                    (8400, 8447): 34,
                    (8448, 8527): 35,
                    (8528, 8591): 36,
                    (8592, 8703): 37,
                    (10224, 10239): 37,
                    (10496, 10623): 37,
                    (11008, 11263): 37,
                    (8704, 8959): 38,
                    (10752, 11007): 38,
                    (10176, 10223): 38,
                    (10624, 10751): 38,
                    (8960, 9215): 39,
                    (9216, 9279): 40,
                    (9280, 9311): 41,
                    (9312, 9471): 42,
                    (9472, 9599): 43,
                    (9600, 9631): 44,
                    (9632, 9727): 45,
                    (9728, 9983): 46,
                    (9984, 10175): 47,
                    (12288, 12351): 48,
                    (12352, 12447): 49,
                    (12448, 12543): 50,
                    (12784, 12799): 50,
                    (12544, 12591): 51,
                    (12704, 12735): 51,
                    (12592, 12687): 52,
                    (43072, 43135): 53,
                    (12800, 13055): 54,
                    (13056, 13311): 55,
                    (44032, 55215): 56,
                    (55296, 57343): 57,
                    (67840, 67871): 58,
                    (19968, 40959): 59,
                    (11904, 12031): 59,
                    (12032, 12255): 59,
                    (12272, 12287): 59,
                    (13312, 19903): 59,
                    (131072, 173791): 59,
                    (12688, 12703): 59,
                    (57344, 63743): 60,
                    (12736, 12783): 61,
                    (63744, 64255): 61,
                    (194560, 195103): 61,
                    (64256, 64335): 62,
                    (64336, 65023): 63,
                    (65056, 65071): 64,
                    (65040, 65055): 65,
                    (65072, 65103): 65,
                    (65104, 65135): 66,
                    (65136, 65279): 67,
                    (65280, 65519): 68,
                    (65520, 65535): 69,
                    (3840, 4095): 70,
                    (1792, 1871): 71,
                    (1920, 1983): 72,
                    (3456, 3583): 73,
                    (4096, 4255): 74,
                    (4608, 4991): 75,
                    (4992, 5023): 75,
                    (11648, 11743): 75,
                    (5024, 5119): 76,
                    (5120, 5759): 77,
                    (5760, 5791): 78,
                    (5792, 5887): 79,
                    (6016, 6143): 80,
                    (6624, 6655): 80,
                    (6144, 6319): 81,
                    (10240, 10495): 82,
                    (40960, 42127): 83,
                    (42128, 42191): 83,
                    (5888, 5919): 84,
                    (5920, 5951): 84,
                    (5952, 5983): 84,
                    (5984, 6015): 84,
                    (66304, 66351): 85,
                    (66352, 66383): 86,
                    (66560, 66639): 87,
                    (118784, 119039): 88,
                    (119040, 119295): 88,
                    (119296, 119375): 88,
                    (119808, 120831): 89,
                    (1044480, 1048573): 90,
                    (1048576, 1114109): 90,
                    (65024, 65039): 91,
                    (917760, 917999): 91,
                    (917504, 917631): 92,
                    (6400, 6479): 93,
                    (6480, 6527): 94,
                    (6528, 6623): 95,
                    (6656, 6687): 96,
                    (11264, 11359): 97,
                    (11568, 11647): 98,
                    (19904, 19967): 99,
                    (43008, 43055): 100,
                    (65536, 65663): 101,
                    (65664, 65791): 101,
                    (65792, 65855): 101,
                    (65856, 65935): 102,
                    (66432, 66463): 103,
                    (66464, 66527): 104,
                    (66640, 66687): 105,
                    (66688, 66735): 106,
                    (67584, 67647): 107,
                    (68096, 68191): 108,
                    (119552, 119647): 109,
                    (73728, 74751): 110,
                    (74752, 74879): 110,
                    (119648, 119679): 111,
                    (7040, 7103): 112,
                    (7168, 7247): 113,
                    (7248, 7295): 114,
                    (43136, 43231): 115,
                    (43264, 43311): 116,
                    (43312, 43359): 117,
                    (43520, 43615): 118,
                    (65936, 65999): 119,
                    (66000, 66047): 120,
                    (66208, 66271): 121,
                    (66176, 66207): 121,
                    (67872, 67903): 121,
                    (127024, 127135): 122,
                    (126976, 127023): 122,
                }
                #123-127    Reserved for process-internal usage
